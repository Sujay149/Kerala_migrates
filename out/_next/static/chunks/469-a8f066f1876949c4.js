"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[469],{3999:(e,t,r)=>{r.d(t,{cn:()=>i});var a=r(2596),o=r(9688);function i(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,o.QP)((0,a.$)(t))}},4236:(e,t,r)=>{r.d(t,{A:()=>s});var a=r(2115),o=r(6203),i=r(8915),n=r(5111);function s(){let[e,t]=(0,a.useState)(null),[r,s]=(0,a.useState)(null),[d,c]=(0,a.useState)(!0);return(0,a.useEffect)(()=>(0,o.hg)(i.j2,async e=>{t(e),e?s(await (0,n.VM)(e.uid)):s(null),c(!1)}),[]),{user:e,userProfile:r,loading:d,signIn:async(e,t)=>(0,o.x9)(i.j2,e,t),signUp:async(e,t,r)=>{let a=await (0,o.eJ)(i.j2,e,t);return r&&a.user&&await (0,o.r7)(a.user,{displayName:r}),a},signInWithGoogle:async()=>(0,o.df)(i.j2,i.hJ),signInWithFacebook:async()=>(0,o.df)(i.j2,i.sj),logout:async()=>(0,o.CI)(i.j2),resetPassword:async e=>(0,o.J1)(i.j2,e)}}},5111:(e,t,r)=>{r.d(t,{$0:()=>p,A0:()=>A,F5:()=>y,IM:()=>u,N6:()=>f,Oc:()=>I,VE:()=>v,VM:()=>s,Vz:()=>n,ZQ:()=>F,_M:()=>J,bs:()=>T,d3:()=>S,dp:()=>h,eX:()=>O,eg:()=>d,fB:()=>l,gJ:()=>x,jw:()=>g,l0:()=>E,mo:()=>m,x:()=>c});var a=r(5317),o=r(858),i=r(8915);let n=async(e,t,r,o,n)=>{try{let s=(0,a.H9)(i.db,"users",e),d={uid:e,email:t,displayName:r||t.split("@")[0],photoURL:o,...n,createdAt:(0,a.O5)(),updatedAt:(0,a.O5)(),preferences:{theme:"dark",notifications:!0,emailNotifications:!0,medicationReminders:!0,appointmentReminders:!0,...null==n?void 0:n.preferences}};return await (0,a.BN)(s,d),await w(e),d}catch(e){throw console.error("Error creating user profile:",e),Error("Failed to create user profile")}},s=async e=>{try{let t=(0,a.H9)(i.db,"users",e),r=await (0,a.x7)(t);if(r.exists())return r.data();return null}catch(e){return console.error("Error getting user profile:",e),null}},d=async(e,t)=>{try{let r=(0,a.H9)(i.db,"users",e);await (0,a.mZ)(r,{...t,updatedAt:(0,a.O5)()})}catch(e){throw console.error("Error updating user profile:",e),Error("Failed to update user profile")}},c=async(e,t)=>{try{let r=(0,o.KR)(i.IG,"profile-pictures/".concat(e,"/").concat(t.name)),a=await (0,o.D)(r,t),n=await (0,o.qk)(a.ref);return await d(e,{photoURL:n}),n}catch(e){throw console.error("Error uploading profile picture:",e),Error("Failed to upload profile picture")}},l=async(e,t)=>{try{let r=(0,a.rJ)(i.db,"chatSessions"),o={userId:e,title:t.slice(0,100),messages:[],createdAt:(0,a.O5)(),updatedAt:(0,a.O5)()};return(await (0,a.gS)(r,o)).id}catch(e){throw console.error("Error creating chat session:",e),Error("Failed to create chat session")}},u=async function(e,t,r,o){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"chat";try{let s=(0,a.H9)(i.db,"chatSessions",e),d=await (0,a.x7)(s);if(!d.exists())throw Error("Session not found");let c=d.data(),l={userId:t,message:r.slice(0,1e3),response:o.slice(0,2e3),type:n,timestamp:new Date},u=[...c.messages||[],l];return await (0,a.mZ)(s,{messages:u,updatedAt:(0,a.O5)()}),l}catch(e){throw console.error("Error adding message to session:",e),Error("Failed to add message")}},p=async e=>{try{let t=(0,a.rJ)(i.db,"chatSessions"),r=(0,a.P)(t,(0,a._M)("userId","==",e),(0,a.AB)(20));return(await (0,a.GG)(r)).docs.map(e=>({id:e.id,...e.data()})).sort((e,t)=>{var r,a;let o=e.updatedAt instanceof Date?e.updatedAt.getTime():(null===(r=e.updatedAt)||void 0===r?void 0:r.seconds)*1e3||0;return(t.updatedAt instanceof Date?t.updatedAt.getTime():(null===(a=t.updatedAt)||void 0===a?void 0:a.seconds)*1e3||0)-o})}catch(e){return console.error("Error getting chat sessions:",e),[]}},m=async e=>{try{let t=(0,a.H9)(i.db,"chatSessions",e);await (0,a.kd)(t)}catch(e){throw console.error("Error deleting chat session:",e),Error("Failed to delete chat session")}},h=async(e,t)=>{try{let r=(0,a.rJ)(i.db,"medications"),o={userId:e,...t,isActive:!0,enableWhatsApp:t.enableWhatsApp||!1,phoneNumber:t.enableWhatsApp?t.phoneNumber:void 0,createdAt:(0,a.O5)(),updatedAt:(0,a.O5)()},n=await (0,a.gS)(r,o);return t.reminderTimes.length&&await b(e,n.id,t.reminderTimes,t.enableWhatsApp,t.phoneNumber),n.id}catch(e){throw console.error("Error adding medication:",e),Error("Failed to add medication")}};async function g(e,t){let r=(0,a.H9)(i.db,"medications",e),o={};for(let[e,r]of Object.entries(t))void 0!==r&&(o[e]=null===r?null:r);o.updatedAt=new Date().toISOString(),await (0,a.mZ)(r,o)}let f=async e=>{try{let t=(0,a.H9)(i.db,"medications",e);await (0,a.kd)(t);let r=(0,a.rJ)(i.db,"medicationReminders"),o=(0,a.P)(r,(0,a._M)("medicationId","==",e));for(let e of(await (0,a.GG)(o)).docs)await (0,a.kd)(e.ref)}catch(e){throw console.error("Error deleting medication:",e),Error("Failed to delete medication")}},y=(e,t)=>{let r=(0,a.rJ)(i.db,"medications"),o=(0,a.P)(r,(0,a._M)("userId","==",e),(0,a.AB)(50));return(0,a.aQ)(o,e=>{try{let r=e.docs.map(e=>({id:e.id,...e.data()})).filter(e=>e.isActive).sort((e,t)=>{var r,a;let o=e.createdAt instanceof Date?e.createdAt.getTime():(null===(r=e.createdAt)||void 0===r?void 0:r.seconds)*1e3||0;return(t.createdAt instanceof Date?t.createdAt.getTime():(null===(a=t.createdAt)||void 0===a?void 0:a.seconds)*1e3||0)-o});t(r)}catch(e){console.error("Error processing medications:",e),t([])}},e=>{console.error("Error in medications listener:",e),t([])})},w=async e=>{try{let t=(0,a.rJ)(i.db,"notificationSettings"),r={userId:e,emailNotifications:!0,pushNotifications:!0,medicationReminders:!0,appointmentReminders:!0,reminderTimes:["09:00","21:00"],createdAt:(0,a.O5)()};return(await (0,a.gS)(t,r)).id}catch(e){throw console.error("Error creating notification settings:",e),Error("Failed to create notification settings")}},b=async(e,t,r,o,n)=>{try{let s=(0,a.rJ)(i.db,"medicationReminders"),d={userId:e,medicationId:t,reminderTimes:r,enableWhatsApp:o||!1,phoneNumber:o?n:null,isActive:!0,createdAt:(0,a.O5)()};if(await (0,a.gS)(s,d),"Notification"in window&&"default"===Notification.permission&&await Notification.requestPermission(),o&&n)for(let e of r)console.log("Scheduling WhatsApp reminder for ".concat(n," at ").concat(e))}catch(e){throw console.error("Error scheduling medication reminders:",e),Error("Failed to schedule reminders")}},A=async(e,t,r,a)=>{try{"Notification"in window&&"granted"===Notification.permission&&new Notification("Medication Reminder",{body:"Time to take your ".concat(t),icon:"/logo.png",badge:"/logo.png",tag:"medication-reminder"}),a&&r&&await fetch("/api/send-whatsapp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:r,message:"Time to take your ".concat(t)})})}catch(e){console.error("Error sending medication reminder:",e)}},v=async(e,t)=>{try{let r=(0,a.rJ)(i.db,"appointments"),o={userId:e,hospitalName:t.hospitalName,hospitalAddress:t.hospitalAddress,hospitalPhone:t.hospitalPhone||"",hospitalLocation:t.hospitalLocation||void 0,doctorName:t.doctorName,appointmentType:t.appointmentType,date:t.date,time:t.time,notes:t.notes||"",status:"scheduled",createdAt:(0,a.O5)(),updatedAt:(0,a.O5)()};return(await (0,a.gS)(r,o)).id}catch(e){throw console.error("Error adding appointment:",e),Error("Failed to add appointment: ".concat(e instanceof Error?e.message:String(e)))}},E=async(e,t)=>{try{let r=(0,a.H9)(i.db,"appointments",e);await (0,a.mZ)(r,{...t,updatedAt:(0,a.O5)()})}catch(e){throw console.error("Error updating appointment:",e),Error("Failed to update appointment")}},S=async e=>{try{let t=(0,a.H9)(i.db,"appointments",e);await (0,a.kd)(t)}catch(e){throw console.error("Error deleting appointment:",e),Error("Failed to delete appointment")}},T=(e,t)=>{let r=(0,a.rJ)(i.db,"appointments"),o=(0,a.P)(r,(0,a._M)("userId","==",e),(0,a.AB)(50));return(0,a.aQ)(o,e=>{try{let r=e.docs.map(e=>({id:e.id,...e.data()})).sort((e,t)=>{let r=new Date("".concat(e.date,"T").concat(e.time)).getTime();return new Date("".concat(t.date,"T").concat(t.time)).getTime()-r});t(r)}catch(e){console.error("Error processing appointments:",e),t([])}},e=>{console.error("Error in appointments listener:",e),t([])})},N=async(e,t)=>{try{let r=(0,a.rJ)(i.db,"healthRecords"),o={userId:e,...t,createdAt:(0,a.O5)()};return(await (0,a.gS)(r,o)).id}catch(e){throw console.error("Error adding health record:",e),Error("Failed to add health record")}},I=async e=>{try{let t=(0,a.rJ)(i.db,"healthRecords"),r=(0,a.P)(t,(0,a._M)("userId","==",e),(0,a.AB)(50));return(await (0,a.GG)(r)).docs.map(e=>({id:e.id,...e.data()})).sort((e,t)=>{var r,a;let o=e.createdAt instanceof Date?e.createdAt.getTime():(null===(r=e.createdAt)||void 0===r?void 0:r.seconds)*1e3||0;return(t.createdAt instanceof Date?t.createdAt.getTime():(null===(a=t.createdAt)||void 0===a?void 0:a.seconds)*1e3||0)-o})}catch(e){return console.error("Error getting health records:",e),[]}},F=async(e,t,r,o)=>{try{let n=(0,a.rJ)(i.db,"summaries"),s={userId:e,originalText:t.slice(0,5e3),summary:r.slice(0,2e3),category:o,createdAt:(0,a.O5)()};return(await (0,a.gS)(n,s)).id}catch(e){throw console.error("Error adding summary:",e),Error("Failed to save summary")}},J=async e=>{try{let t=(0,a.rJ)(i.db,"summaries"),r=(0,a.P)(t,(0,a._M)("userId","==",e),(0,a.AB)(20));return(await (0,a.GG)(r)).docs.map(e=>({id:e.id,...e.data()})).sort((e,t)=>{var r,a;let o=e.createdAt instanceof Date?e.createdAt.getTime():(null===(r=e.createdAt)||void 0===r?void 0:r.seconds)*1e3||0;return(t.createdAt instanceof Date?t.createdAt.getTime():(null===(a=t.createdAt)||void 0===a?void 0:a.seconds)*1e3||0)-o})}catch(e){return console.error("Error getting summaries:",e),[]}},O=(e,t)=>{let r=(0,a.rJ)(i.db,"chatSessions"),o=(0,a.P)(r,(0,a._M)("userId","==",e),(0,a.AB)(20));return(0,a.aQ)(o,e=>{try{let r=e.docs.map(e=>({id:e.id,...e.data()})).sort((e,t)=>{var r,a;let o=e.updatedAt instanceof Date?e.updatedAt.getTime():(null===(r=e.updatedAt)||void 0===r?void 0:r.seconds)*1e3||0;return(t.updatedAt instanceof Date?t.updatedAt.getTime():(null===(a=t.updatedAt)||void 0===a?void 0:a.seconds)*1e3||0)-o});t(r)}catch(e){console.error("Error processing chat sessions:",e),t([])}},e=>{console.error("Error in chat sessions listener:",e),t([])})},x=async e=>{try{let t={type:"symptom",title:"Sample Health Record",description:"This is a sample health record for testing purposes",date:new Date().toISOString().split("T")[0]};return N(e,t)}catch(e){throw console.error("Error creating sample health record:",e),Error("Failed to create sample health record")}}},7168:(e,t,r)=>{r.d(t,{$:()=>c});var a=r(5155),o=r(2115),i=r(9708),n=r(2085),s=r(3999);let d=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=o.forwardRef((e,t)=>{let{className:r,variant:o,size:n,asChild:c=!1,...l}=e,u=c?i.DX:"button";return(0,a.jsx)(u,{className:(0,s.cn)(d({variant:o,size:n,className:r})),ref:t,...l})});c.displayName="Button"},8915:(e,t,r)=>{let a;r.d(t,{IG:()=>p,db:()=>u,hJ:()=>m,j2:()=>l,sj:()=>h});var o=r(3915),i=r(6203),n=r(5317),s=r(858),d=r(996);let c={apiKey:"AIzaSyAB5TldoIqRS_WfUlF7JYfVnzXi3i96dmw",authDomain:"MigrantBot-457514.firebaseapp.com",projectId:"MigrantBot-457514",storageBucket:"MigrantBot-457514.firebasestorage.app",messagingSenderId:"806828516267",appId:"1:806828516267:web:a75aad403f3dfbc67da8ee",measurementId:"G-4S6ZN10CRC"};try{a=(0,o.Wp)(c)}catch(e){console.error("Firebase initialization error:",e),a=(0,o.Wp)(c)}let l=(0,i.xI)(a),u=(0,n.aU)(a),p=(0,s.c7)(a);(0,d.dG)(a);let m=new i.HF,h=new i.sk;m.setCustomParameters({prompt:"select_account"}),h.setCustomParameters({display:"popup"})}}]);