(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[457],{2486:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(9946).A)("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]])},3717:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(9946).A)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},4355:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(9946).A)("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]])},4357:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(9946).A)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]])},5784:(e,s,t)=>{"use strict";t.d(s,{bq:()=>u,eb:()=>g,gC:()=>p,l6:()=>c,yv:()=>m});var a=t(5155),r=t(2115),n=t(2748),l=t(6474),o=t(7863),i=t(5196),d=t(3999);let c=n.bL;n.YJ;let m=n.WT,u=r.forwardRef((e,s)=>{let{className:t,children:r,...o}=e;return(0,a.jsxs)(n.l9,{ref:s,className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...o,children:[r,(0,a.jsx)(n.In,{asChild:!0,children:(0,a.jsx)(l.A,{className:"h-4 w-4 opacity-50"})})]})});u.displayName=n.l9.displayName;let x=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(n.PP,{ref:s,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",t),...r,children:(0,a.jsx)(o.A,{className:"h-4 w-4"})})});x.displayName=n.PP.displayName;let h=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(n.wn,{ref:s,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",t),...r,children:(0,a.jsx)(l.A,{className:"h-4 w-4"})})});h.displayName=n.wn.displayName;let p=r.forwardRef((e,s)=>{let{className:t,children:r,position:l="popper",...o}=e;return(0,a.jsx)(n.ZL,{children:(0,a.jsxs)(n.UC,{ref:s,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:l,...o,children:[(0,a.jsx)(x,{}),(0,a.jsx)(n.LM,{className:(0,d.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,a.jsx)(h,{})]})})});p.displayName=n.UC.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(n.JU,{ref:s,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...r})}).displayName=n.JU.displayName;let g=r.forwardRef((e,s)=>{let{className:t,children:r,...l}=e;return(0,a.jsxs)(n.q7,{ref:s,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...l,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(n.VF,{children:(0,a.jsx)(i.A,{className:"h-4 w-4"})})}),(0,a.jsx)(n.p4,{children:r})]})});g.displayName=n.q7.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(n.wv,{ref:s,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",t),...r})}).displayName=n.wv.displayName},8145:(e,s,t)=>{"use strict";t.d(s,{E:()=>o});var a=t(5155);t(2115);var r=t(2085),n=t(3999);let l=(0,r.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function o(e){let{className:s,variant:t,...r}=e;return(0,a.jsx)("div",{className:(0,n.cn)(l({variant:t}),s),...r})}},8179:(e,s,t)=>{Promise.resolve().then(t.bind(t,8406))},8406:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>L});var a=t(5155),r=t(2115),n=t(6766),l=t(9685),o=t(7365),i=t(7168),d=t(9852),c=t(9663),m=t(9840),u=t(8482),x=t(8145),h=t(5784),p=t(4357),g=t(9946);let f=(0,g.A)("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]),v=(0,g.A)("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]]);var b=t(3717),y=t(4783),j=t(4616),w=t(4355);let N=(0,g.A)("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),k=(0,g.A)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);var C=t(2486),A=t(4416),P=t(7434),z=t(215);let S=(0,g.A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var M=t(4236),E=t(5111),R=t(6671),I=t(6874),D=t.n(I);function L(){var e,s;let[t,g]=(0,r.useState)(!1),[I,L]=(0,r.useState)(""),[U,q]=(0,r.useState)(null),[T,F]=(0,r.useState)(!1),[$,H]=(0,r.useState)([]),[O,J]=(0,r.useState)(!1),[Y,V]=(0,r.useState)(!1),[_,G]=(0,r.useState)(null),[W,B]=(0,r.useState)(!1),[Z,K]=(0,r.useState)(null),[X,Q]=(0,r.useState)(""),[ee,es]=(0,r.useState)("gemini-1.5-flash-latest"),[et,ea]=(0,r.useState)(null),[er,en]=(0,r.useState)(""),{user:el,userProfile:eo}=(0,M.A)(),ei=(0,r.useRef)(null),ed=(0,r.useRef)(null);(0,r.useEffect)(()=>{if(!el)return;let e=(0,E.eX)(el.uid,e=>{let s=e.map(e=>{var s;return{...e,messages:null!==(s=e.messages)&&void 0!==s?s:[]}});H(s),!U&&s.length>0&&q(s[0])});return()=>e()},[el,U]),(0,r.useEffect)(()=>{ec()},[null==U?void 0:U.messages]);let ec=()=>{var e;null===(e=ei.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},em=async()=>{if(!el){R.o.error("Please log in to start a new chat");return}try{let e={id:await (0,E.fB)(el.uid,"New Chat"),userId:el.uid,title:"New Chat",messages:[],createdAt:new Date,updatedAt:new Date};q(e),R.o.success("New chat started!")}catch(e){console.error("Error starting new chat:",e),R.o.error("Failed to start new chat")}},eu=async()=>{if(!el){R.o.error("Please log in to send messages");return}if(!I.trim()&&!et)return;let e=I.trim()||"Image uploaded";L(""),ea(null),en(""),ed.current&&(ed.current.value=""),F(!0);try{let s=U;if(!s){let e=I.trim()?eg(I):"Image Analysis";s={id:await (0,E.fB)(el.uid,e),userId:el.uid,title:e,messages:[],createdAt:new Date,updatedAt:new Date},q(s)}let t="";if(I.trim()&&(t=await ev(I)),et){let e=await eb(et),s="**Prescription Analysis**:\n- **Medications**: ".concat(e.medications.join(", "),"\n- **Dosages**: ").concat(e.dosages.join(", "),"\n- **Instructions**: ").concat(e.instructions).concat(e.warnings.length?"\n- **Warnings**: "+e.warnings.join(", "):"");t=t?"".concat(t,"\n\n").concat(s):s}if(s.id){let a=await (0,E.IM)(s.id,el.uid,e,t,"chat");q(e=>{var s;return e?{...e,messages:[...null!==(s=e.messages)&&void 0!==s?s:[],a],updatedAt:new Date}:e}),ef(e,t),R.o.success("Message sent!")}}catch(e){console.error("Error sending message:",e),R.o.error("Failed to send message. Please try again."),L(I),et&&(ea(et),en(et.name))}finally{F(!1)}},ex=async(e,s)=>{if(!el){R.o.error("Please log in to edit messages");return}if(Z===e){if(!X.trim()){R.o.error("Message cannot be empty");return}try{F(!0);let s=await ev(X),a=null==U?void 0:U.id;if(a){var t;let r=(null!==(t=null==U?void 0:U.messages)&&void 0!==t?t:[]).map((t,a)=>"user-".concat(a)===e?{...t,message:X,response:s}:t);await (0,E.IM)(a,el.uid,X,s,"chat"),q(e=>e?{...e,messages:r}:e),R.o.success("Message updated!")}}catch(e){console.error("Error editing message:",e),R.o.error("Failed to edit message")}finally{K(null),Q(""),F(!1)}}else K(e),Q(s)},eh=e=>{navigator.clipboard.writeText(e),R.o.success("Copied to clipboard!")},ep=(e,s)=>{R.o.success(s?"Thanks for the thumbs up!":"Thanks for the feedback!")},eg=e=>{let s=e.toLowerCase();if(s.includes("headache")||s.includes("migraine"))return"Headache Consultation";if(s.includes("fever")||s.includes("temperature"))return"Fever Assessment";if(s.includes("medication")||s.includes("medicine"))return"Medication Inquiry";if(s.includes("diet")||s.includes("nutrition"))return"Nutrition Guidance";if(s.includes("exercise")||s.includes("workout"))return"Exercise Consultation";if(s.includes("sleep")||s.includes("insomnia"))return"Sleep Health";if(s.includes("stress")||s.includes("anxiety"))return"Mental Health Support";if(s.includes("pain"))return"Pain Management";let t=e.split(" ").filter(e=>e.length>3);return t.length>0?"".concat(t[0].charAt(0).toUpperCase()+t[0].slice(1)," Discussion"):"Health Consultation"},ef=(e,s)=>{"Notification"in window&&"granted"===Notification.permission&&new Notification("MigrantBot Response",{body:"Your health question has been answered",icon:"/logo.png",badge:"/logo.png"})},ev=async e=>{try{var s,t,a,r,n,l;let o="grok"===ee?"https://api.x.ai/v1/models/grok:generateContent":"https://generativelanguage.googleapis.com/v1beta/models/".concat(ee,":generateContent"),i=await fetch("".concat(o,"?key=").concat("AIzaSyDNHY0ptkqYXxknm1qJYP_tCw2A12be_gM"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:"You are MigrantBot, a health-focused AI assistant. Provide a concise, informative, and professional response to the following health-related user query. Ensure the response is educational, not a substitute for professional medical advice, and includes a reminder to consult a healthcare professional for personalized advice. Query: ".concat(e)}]}],generationConfig:{temperature:.7,maxOutputTokens:200}})});if(!i.ok)throw Error("HTTP error! status: ".concat(i.status));let d=await i.json();return(null===(l=d.candidates)||void 0===l?void 0:null===(n=l[0])||void 0===n?void 0:null===(r=n.content)||void 0===r?void 0:null===(a=r.parts)||void 0===a?void 0:null===(t=a[0])||void 0===t?void 0:null===(s=t.text)||void 0===s?void 0:s.trim())||"No response generated."}catch(e){return console.error("Error calling AI API:",e),"I'm sorry, I couldn't process your request at this time. Please try again later or consult a healthcare professional for personalized advice"}},eb=async e=>{try{var s,t,a,r,n;let l;let o="grok"===ee?"https://api.x.ai/v1/models/grok:analyzePrescription":"https://generativelanguage.googleapis.com/v1beta/models/".concat(ee,":generateContent"),i=await fetch("".concat(o,"?key=").concat("AIzaSyDNHY0ptkqYXxknm1qJYP_tCw2A12be_gM"),{method:"POST",body:JSON.stringify({contents:[{parts:[{text:"Analyze this prescription image and extract medications, dosages, instructions, and any warnings. Return the response in JSON format with fields: medications (array), dosages (array), instructions (string), warnings (array)."},{inlineData:{mimeType:e.type,data:await ey(e)}}]}],generationConfig:{temperature:.5,maxOutputTokens:500}})});if(!i.ok)throw Error("HTTP error! status: ".concat(i.status));let d=await i.json(),c=(null===(n=d.candidates)||void 0===n?void 0:null===(r=n[0])||void 0===r?void 0:null===(a=r.content)||void 0===a?void 0:null===(t=a.parts)||void 0===t?void 0:null===(s=t[0])||void 0===s?void 0:s.text)||"{}";c=c.replace(/```json/g,"").replace(/```/g,"").replace(/`/g,"").trim();try{l=JSON.parse(c)}catch(e){throw console.error("JSON parse error:",e),Error("Invalid JSON response")}return{medications:l.medications||["Unknown"],dosages:l.dosages||["Unknown"],instructions:l.instructions||"No instructions provided.",warnings:l.warnings||[]}}catch(e){return console.error("Error analyzing prescription:",e),{medications:["Error"],dosages:["N/A"],instructions:"Failed to analyze prescription.",warnings:["Pleaseooooooooo try again or consult a healthcare professional."]}}},ey=e=>new Promise((s,t)=>{let a=new FileReader;a.onload=()=>{s(a.result.split(",")[1])},a.onerror=()=>t(Error("Failed to read file")),a.readAsDataURL(e)}),ej=e=>{if(!el){R.o.error("Please log in to send messages");return}"Enter"!==e.key||e.shiftKey||(e.preventDefault(),Z?ex(Z,X):eu())},ew=()=>{var e;if(!el){R.o.error("Please log in to upload files");return}null===(e=ed.current)||void 0===e||e.click()};return(0,a.jsx)(o.q,{children:(0,a.jsxs)("div",{className:"bg-background text-foreground min-h-screen flex h-screen overflow-hidden",children:[(0,a.jsx)(l.B,{isOpen:t,onClose:()=>g(!1)}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 sm:p-4 border-b border-border bg-card",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 sm:space-x-3",children:[(0,a.jsx)(i.$,{variant:"ghost",size:"icon",onClick:()=>g(!0),className:"text-muted-foreground hover:text-foreground lg:hidden h-10 w-10","aria-label":"Open sidebar",children:(0,a.jsx)(y.A,{className:"h-5 w-5"})}),(0,a.jsx)("h1",{className:"font-semibold text-lg",children:"Your Personalized MigrantBot"})]}),(0,a.jsx)("div",{className:"flex items-center space-x-1 sm:space-x-2",children:el?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.$,{onClick:em,variant:"ghost",size:"icon",className:"text-muted-foreground hover:text-foreground hover:bg-muted h-8 w-8 sm:h-10 sm:w-10",title:"Start New Chat","aria-label":"Start New Chat",children:(0,a.jsx)(j.A,{className:"h-4 w-4 sm:h-5 sm:w-5"})}),(0,a.jsx)(i.$,{onClick:()=>{if(!el){R.o.error("Please log in to analyze prescriptions");return}J(!0),G(null)},variant:"ghost",size:"icon",className:"text-muted-foreground hover:text-foreground hover:bg-muted h-8 w-8 sm:h-10 sm:w-10",title:"Prescription Analysis","aria-label":"Prescription Analysis",children:(0,a.jsx)(w.A,{className:"h-4 w-4 sm:h-5 sm:w-5"})}),(0,a.jsx)(i.$,{onClick:()=>{if(!el){R.o.error("Please log in to view chat history");return}V(!0)},variant:"ghost",size:"icon",className:"text-muted-foreground hover:text-foreground hover:bg-muted h-8 w-8 sm:h-10 sm:w-10",title:"Chat History","aria-label":"Chat History",children:(0,a.jsx)(N,{className:"h-4 w-4 sm:h-5 sm:w-5"})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(D(),{href:"/auth/signin",children:(0,a.jsx)(i.$,{variant:"outline",className:"bg-muted border-border text-foreground hover:bg-purple-600 hover:text-white text-xs sm:text-sm h-8 sm:h-10 px-2 sm:px-4",children:"Login"})}),(0,a.jsx)(D(),{href:"/auth/signup",children:(0,a.jsx)(i.$,{variant:"outline",className:"bg-muted border-border text-foreground hover:bg-purple-600 hover:text-white text-xs sm:text-sm h-8 sm:h-10 px-2 sm:px-4",children:"Signup"})})]})})]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto p-3 sm:p-4 md:p-6",children:(0,a.jsxs)("div",{className:"max-w-full sm:max-w-3xl md:max-w-4xl mx-auto space-y-4 sm:space-y-6",children:[el?U&&0!==(null!==(s=U.messages)&&void 0!==s?s:[]).length?(0,a.jsx)(a.Fragment,{children:(()=>{if(!el||!(null==U?void 0:U.messages)||0===U.messages.length)return null;let e=[];return U.messages.forEach((s,t)=>{e.push({type:"user",content:s.message,timestamp:s.timestamp,id:"user-".concat(t)}),s.response&&e.push({type:"bot",content:s.response,timestamp:s.timestamp,id:"bot-".concat(t)})}),e.map(e=>{var s,t,r;return(0,a.jsxs)("div",{className:"flex ".concat("user"===e.type?"justify-end":"items-start space-x-2 sm:space-x-3"," mb-3 sm:mb-4"),children:["bot"===e.type&&(0,a.jsx)("div",{className:"flex-1 max-w-[80%] sm:max-w-3xl",children:(0,a.jsxs)("div",{className:"bg-muted rounded-xl rounded-tl-md p-3 sm:p-4 text-foreground text-xs sm:text-sm leading-relaxed border border-border whitespace-pre-wrap",children:[e.content.split("\n").map((e,s)=>(0,a.jsx)("p",{className:e.startsWith("**")?"font-semibold":"",children:e},s)),(0,a.jsxs)("div",{className:"flex space-x-2 mt-2",children:[(0,a.jsx)(i.$,{variant:"ghost",size:"icon",onClick:()=>eh(e.content),className:"text-muted-foreground hover:text-foreground h-6 w-6",title:"Copy Response",children:(0,a.jsx)(p.A,{className:"h-4 w-4"})}),(0,a.jsx)(i.$,{variant:"ghost",size:"icon",onClick:()=>ep(e.id,!0),className:"text-muted-foreground hover:text-green-500 h-6 w-6",title:"Thumbs Up",children:(0,a.jsx)(f,{className:"h-4 w-4"})}),(0,a.jsx)(i.$,{variant:"ghost",size:"icon",onClick:()=>ep(e.id,!1),className:"text-muted-foreground hover:text-red-500 h-6 w-6",title:"Thumbs Down","aria-label":"Thumbs Down",children:(0,a.jsx)(v,{className:"h-4 w-4"})})]})]})}),"user"===e.type&&(0,a.jsxs)("div",{className:"flex items-start space-x-2 sm:space-x-3 max-w-[70%] sm:max-w-md",children:[(0,a.jsxs)("div",{className:"bg-purple-600 rounded-xl rounded-tr-md p-3 sm:p-4 text-white text-xs sm:text-sm leading-relaxed",children:[Z===e.id?(0,a.jsx)(d.p,{value:X,onChange:e=>Q(e.target.value),onKeyPress:ej,className:"bg-muted border-border text-foreground focus:outline-none focus:ring-2 focus:ring-purple-600"}):e.content,(0,a.jsxs)("div",{className:"flex space-x-2 mt-2",children:[(0,a.jsx)(i.$,{variant:"ghost",size:"icon",onClick:()=>eh(e.content),className:"text-white hover:text-gray-200 h-6 w-6",title:"Copy Message",children:(0,a.jsx)(p.A,{className:"h-4 w-4"})}),(0,a.jsx)(i.$,{variant:"ghost",size:"icon",onClick:()=>ex(e.id,e.content),className:"text-white hover:text-gray-200 h-6 w-6",title:Z===e.id?"Save Edit":"Edit Message",children:(0,a.jsx)(b.A,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)(c.eu,{className:"w-6 h-6 sm:w-8 sm:h-8 mt-1 flex-shrink-0",children:[(0,a.jsx)(c.BK,{src:(null==eo?void 0:eo.photoURL)||(null==el?void 0:el.photoURL)||""}),(0,a.jsx)(c.q5,{className:"bg-purple-600 text-white text-xs sm:text-sm",children:(null==eo?void 0:null===(s=eo.displayName)||void 0===s?void 0:s.charAt(0).toUpperCase())||(null==el?void 0:null===(t=el.displayName)||void 0===t?void 0:t.charAt(0).toUpperCase())||(null==el?void 0:null===(r=el.email)||void 0===r?void 0:r.charAt(0).toUpperCase())||"U"})]})]})]},e.id)})})()}):(0,a.jsx)("div",{className:"min-h-full flex items-center justify-center",children:(0,a.jsx)("div",{className:"w-full max-w-md text-center space-y-8",children:(0,a.jsxs)("div",{className:"flex flex-col items-center space-y-6",children:[(0,a.jsx)("div",{className:"w-20 h-20 relative",children:(0,a.jsx)(n.default,{src:"/logo.png",alt:"MigrantBot Logo",width:80,height:80,className:"rounded-full"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Welcome to MigrantBot"}),(0,a.jsx)("p",{className:"text-muted-foreground text-sm",children:"Start a conversation below."})]})]})})}):(0,a.jsx)("div",{className:"min-h-full flex items-center justify-center",children:(0,a.jsxs)("div",{className:"w-full max-w-md text-center space-y-8",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center space-y-6",children:[(0,a.jsx)("div",{className:"w-20 h-20 relative",children:(0,a.jsx)(n.default,{src:"/logo.png",alt:"MigrantBot Logo",width:80,height:80,className:"rounded-full"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Welcome to MigrantBot"}),(0,a.jsx)("p",{className:"text-muted-foreground text-sm",children:"Please log in or sign up to start chatting."})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(D(),{href:"/auth/signin",className:"block",children:(0,a.jsx)(i.$,{variant:"outline",className:"w-full h-12 bg-muted border-border text-foreground hover:bg-purple-600 hover:text-white rounded-xl",children:"Login"})}),(0,a.jsx)(D(),{href:"/auth/signup",className:"block",children:(0,a.jsx)(i.$,{variant:"outline",className:"w-full h-12 bg-muted border-border text-foreground hover:bg-purple-600 hover:text-white rounded-xl",children:"Signup"})})]})]})}),T&&el&&(0,a.jsx)("div",{className:"flex items-start space-x-2 sm:space-x-4",children:(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("div",{className:"bg-muted rounded-xl rounded-tl-md p-3 sm:p-4 border border-border",children:(0,a.jsxs)("div",{className:"flex space-x-1",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-muted-foreground rounded-full animate-bounce"}),(0,a.jsx)("div",{className:"w-2 h-2 bg-muted-foreground rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,a.jsx)("div",{className:"w-2 h-2 bg-muted-foreground rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})})}),(0,a.jsx)("div",{ref:ei})]})}),el&&(0,a.jsx)("div",{className:"p-3 sm:p-4 md:p-6 border-t border-border bg-card sticky bottom-0",children:(0,a.jsx)("div",{className:"max-w-full sm:max-w-3xl md:max-w-4xl mx-auto",children:(0,a.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 sm:space-x-3",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(d.p,{value:I,onChange:e=>L(e.target.value),onKeyPress:ej,placeholder:"Ask a health question or upload an image...",className:"bg-muted border-border text-foreground placeholder-muted-foreground h-10 sm:h-11 md:h-12 rounded-xl pr-36 sm:pr-40 text-xs sm:text-sm md:text-base focus:outline-none focus:ring-2 focus:ring-purple-600",disabled:T,maxLength:1e3}),(0,a.jsxs)("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 flex items-center space-x-1",children:[(0,a.jsx)(i.$,{onClick:ew,variant:"ghost",size:"icon",className:"text-muted-foreground hover:text-foreground hover:bg-muted h-6 w-6 sm:h-7 sm:w-7",title:"Upload Image","aria-label":"Upload Image",children:(0,a.jsx)(k,{className:"h-4 w-4 sm:h-5 sm:w-5"})}),(0,a.jsx)("input",{ref:ed,type:"file",accept:"image/*",onChange:e=>{var s;if(!el){R.o.error("Please log in to upload files");return}let t=null===(s=e.target.files)||void 0===s?void 0:s[0];t&&(ea(t),en(t.name))},className:"hidden"}),(0,a.jsxs)(h.l6,{value:ee,onValueChange:es,children:[(0,a.jsx)(h.bq,{className:"w-[100px] sm:w-[120px] bg-muted border-border text-foreground text-xs h-6 sm:h-7 focus:outline-none focus:ring-2 focus:ring-purple-600",children:(0,a.jsx)(h.yv,{placeholder:"Model"})}),(0,a.jsxs)(h.gC,{className:"bg-card border-border text-foreground text-xs shadow-lg",children:[(0,a.jsx)(h.eb,{value:"gemini-1.5-flash-latest",children:"Gemini 1.5 Flash"}),(0,a.jsx)(h.eb,{value:"gemini-1.5-pro-latest",children:"Gemini 1.5 Pro"}),(0,a.jsx)(h.eb,{value:"grok",children:"Grok (Beta)"})]})]})]})]}),(0,a.jsx)(i.$,{onClick:eu,disabled:T||!I.trim()&&!et,size:"icon",className:"bg-purple-600 hover:bg-purple-700 text-white rounded-full h-10 w-10 sm:h-11 sm:w-11 md:h-12 md:w-12 shadow-lg disabled:opacity-50","aria-label":"Send Message",children:(0,a.jsx)(C.A,{className:"h-4 w-4 sm:h-5 sm:w-5"})})]}),er&&(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(x.E,{variant:"secondary",className:"bg-muted text-muted-foreground text-xs truncate max-w-[200px] sm:max-w-[300px]",children:er}),(0,a.jsx)(i.$,{onClick:()=>{ea(null),en(""),ed.current&&(ed.current.value="")},variant:"ghost",size:"icon",className:"text-muted-foreground hover:text-red-500 h-6 w-6",title:"Remove File","aria-label":"Remove File",children:(0,a.jsx)(A.A,{className:"h-4 w-4"})})]})]})})})]}),el&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.lG,{open:O,onOpenChange:J,children:(0,a.jsxs)(m.Cf,{className:"bg-card border-border text-foreground max-w-[90vw] sm:max-w-2xl mx-auto max-h-[90vh] sm:max-h-[80vh] overflow-y-auto sm:rounded-xl p-4 sm:p-6 shadow",children:[(0,a.jsx)(m.c7,{children:(0,a.jsxs)(m.L3,{className:"flex items-center space-x-2 text-lg",children:[(0,a.jsx)(w.A,{className:"h-5 w-5 text-muted-foreground"}),(0,a.jsx)("span",{children:"Prescription Analysis"})]})}),_?(0,a.jsxs)("div",{className:"space-y-4 sm:space-y-6",children:[(0,a.jsxs)(u.Zp,{className:"bg-card border-border rounded-xl shadow",children:[(0,a.jsx)(u.aR,{children:(0,a.jsxs)(u.ZB,{className:"flex items-center space-x-2 text-lg",children:[(0,a.jsx)(P.A,{className:"h-5 w-5 text-muted-foreground"}),(0,a.jsx)("span",{children:"Analysis Results"})]})}),(0,a.jsxs)(u.Wu,{className:"space-y-3 sm:space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-3 sm:gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold text-sm mb-1 sm:mb-2",children:"Detected Medications"}),(0,a.jsx)("div",{className:"space-y-1 sm:space-y-2 flex flex-wrap gap-1",children:_.medications.map((e,s)=>(0,a.jsxs)(x.E,{className:"bg-purple-600 text-white text-xs sm:text-sm mr-1 mb-1",children:[(0,a.jsx)(z.A,{className:"mr-1 h-3 w-3 sm:h-3 sm:w-3"}),e]},s))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold text-sm mb-1 sm:mb-2",children:"Dosage Information"}),(0,a.jsx)("div",{className:"space-y-1 sm:space-y-2 flex flex-wrap gap-1",children:_.dosages.map((e,s)=>(0,a.jsx)(x.E,{variant:"secondary",className:"bg-muted text-muted-foreground text-xs sm:text-sm mr-1 mb-1",children:e},s))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold text-sm mb-1 sm:mb-2",children:"Instructions"}),(0,a.jsx)("p",{className:"text-muted-foreground text-xs sm:text-sm bg-muted p-2 sm:p-3 rounded-lg",children:_.instructions})]}),(null===(e=_.warnings)||void 0===e?void 0:e.length)>0&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"font-semibold text-sm mb-1 sm:mb-2 flex items-center",children:[(0,a.jsx)(S,{className:"mr-1 h-4 w-4 sm:h-5 sm:w-5 text-yellow-500"}),(0,a.jsx)("span",{children:"Warnings & Precautions"})]}),(0,a.jsx)("div",{className:"space-y-1 sm:space-y-2",children:_.warnings.map((e,s)=>(0,a.jsx)("div",{className:"bg-yellow-900/20 border border-yellow-700 p-2 sm:p-3 rounded-lg",children:(0,a.jsx)("p",{className:"text-yellow-300 text-xs sm:text-sm",children:e})},s))})]}),(0,a.jsx)("div",{className:"bg-blue-900/20 border border-blue-700 p-3 sm:p-4 rounded-lg",children:(0,a.jsxs)("p",{className:"text-blue-300 text-sm",children:[(0,a.jsx)("strong",{children:"Important:"})," This analysis is for informational purposes only. Always follow your doctor's instructions and consult your pharmacist."]})})]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3",children:[(0,a.jsx)(i.$,{onClick:()=>{G(null),J(!1)},variant:"outline",className:"flex-1 bg-muted border-border text-foreground hover:bg-purple-600 hover:text-white text-sm",children:"Close"}),(0,a.jsx)(i.$,{onClick:()=>G(null),className:"flex-1 bg-purple-600 hover:bg-purple-700 text-white text-sm",children:"Analyze Another"})]})]}):(0,a.jsxs)("div",{className:"space-y-3 sm:space-y-4",children:[(0,a.jsx)("p",{className:"text-muted-foreground text-xs sm:text-sm",children:"Upload a photo of your prescription for AI-powered analysis and information."}),(0,a.jsx)("div",{className:"border-2 border-dashed border-border rounded-xl p-6 sm:p-8 text-center",children:W?(0,a.jsxs)("div",{className:"space-y-3 sm:space-y-4",children:[(0,a.jsx)("div",{className:"w-10 h-10 sm:w-12 sm:h-12 border-4 border-purple-600 border-t-transparent rounded-full animate-spin mx-auto"}),(0,a.jsx)("p",{className:"text-muted-foreground text-xs sm:text-sm",children:"Analyzing prescription..."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(w.A,{className:"h-10 w-10 sm:h-12 sm:w-12 text-muted-foreground mx-auto mb-3 sm:mb-4"}),(0,a.jsx)("p",{className:"text-muted-foreground text-xs sm:text-sm mb-3 sm:mb-4",children:"Upload prescription image"}),(0,a.jsxs)(i.$,{onClick:ew,className:"bg-purple-600 hover:bg-purple-700 text-white text-xs sm:text-sm",children:[(0,a.jsx)(k,{className:"mr-1 h-3 w-3 sm:h-4 sm:w-4"}),"Choose File"]})]})}),(0,a.jsx)("input",{ref:ed,type:"file",accept:"image/*",onChange:e=>{var s;let t=null===(s=e.target.files)||void 0===s?void 0:s[0];t&&(B(!0),eb(t).then(e=>{G(e),R.o.success("Prescription analyzed successfully!")}).catch(e=>{console.error("Error analyzing prescription:",e),R.o.error("Failed to analyze prescription")}).finally(()=>{B(!1),ed.current&&(ed.current.value="")}))},className:"hidden"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Supported formats: JPG, PNG, HEIC. This feature analyzes prescription information for educational purposes only."})]})]})}),(0,a.jsx)(m.lG,{open:Y,onOpenChange:V,children:(0,a.jsxs)(m.Cf,{className:"bg-card border-border text-foreground max-w-md mx-auto p-6 sm:p-6 rounded-xl shadow",children:[(0,a.jsx)(m.c7,{children:(0,a.jsx)(m.L3,{className:"flex items-center justify-between text-lg",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(N,{className:"h-5 w-5 text-muted-foreground"}),(0,a.jsx)("span",{children:"Recent Chats"})]})})}),(0,a.jsx)("div",{className:"space-y-4 overflow-y-auto max-h-96",children:$.length>0?$.slice(0,10).map(e=>{var s,t,r,n;return(0,a.jsx)("div",{className:"p-4 rounded-xl border border-border cursor-pointer transition-colors ".concat((null==U?void 0:U.id)===e.id?"bg-purple-600/20 border-purple-600":"bg-muted hover:bg-purple-600/10"),onClick:()=>{q(e),V(!1)},children:(0,a.jsx)("div",{className:"flex items-start justify-between",children:(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-semibold text-sm truncate",children:e.title}),(0,a.jsxs)("p",{className:"text-muted-foreground text-sm",children:[(e.messages||[]).length," messages •"," ",e.updatedAt instanceof Date?e.updatedAt.toLocaleDateString():(null===(r=e.updatedAt)||void 0===r?void 0:null===(t=r.toDate)||void 0===t?void 0:null===(s=t.call(r))||void 0===s?void 0:s.toLocaleDateString())||"Recently"]}),(e.messages||[]).length>0&&(0,a.jsx)("p",{className:"text-muted-foreground text-sm mt-1 truncate",children:(null===(n=e.messages[e.messages.length-1])||void 0===n?void 0:n.message)||"No messages"})]})})},e.id)}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(N,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-muted-foreground text-sm",children:"No chat history yet"}),(0,a.jsx)("p",{className:"text-muted-foreground text-sm",children:"Start a conversation to see your history here"})]})}),(0,a.jsx)("div",{className:"flex justify-end pt-4 border-t border-border",children:(0,a.jsx)(D(),{href:"/history",children:(0,a.jsx)(i.$,{variant:"outline",className:"bg-muted border-border text-foreground hover:bg-purple-600 hover:text-white text-sm",onClick:()=>V(!1),children:"View Full History"})})})]})})]})]})})}},9840:(e,s,t)=>{"use strict";t.d(s,{Cf:()=>u,L3:()=>h,c7:()=>x,lG:()=>i,zM:()=>d});var a=t(5155),r=t(2115),n=t(5452),l=t(4416),o=t(3999);let i=n.bL,d=n.l9,c=n.ZL;n.bm;let m=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(n.hJ,{ref:s,className:(0,o.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...r})});m.displayName=n.hJ.displayName;let u=r.forwardRef((e,s)=>{let{className:t,children:r,...i}=e;return(0,a.jsxs)(c,{children:[(0,a.jsx)(m,{}),(0,a.jsxs)(n.UC,{ref:s,className:(0,o.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...i,children:[r,(0,a.jsxs)(n.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(l.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});u.displayName=n.UC.displayName;let x=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,o.cn)("flex flex-col space-y-1.5 text-center sm:text-left",s),...t})};x.displayName="DialogHeader";let h=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(n.hE,{ref:s,className:(0,o.cn)("text-lg font-semibold leading-none tracking-tight",t),...r})});h.displayName=n.hE.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(n.VY,{ref:s,className:(0,o.cn)("text-sm text-muted-foreground",t),...r})}).displayName=n.VY.displayName},9852:(e,s,t)=>{"use strict";t.d(s,{p:()=>l});var a=t(5155),r=t(2115),n=t(3999);let l=r.forwardRef((e,s)=>{let{className:t,type:r,...l}=e;return(0,a.jsx)("input",{type:r,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:s,...l})});l.displayName="Input"}},e=>{var s=s=>e(e.s=s);e.O(0,[992,163,455,671,45,259,527,375,988,626,469,754,441,684,358],()=>s(8179)),_N_E=e.O()}]);